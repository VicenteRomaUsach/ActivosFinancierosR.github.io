<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>quarto-inputbcb87ff52309e351</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<pre><code>  
      </code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://portal.usach.cl/sites/default/files/Usach%20P1%20%281%29.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
<pre><code>  
      </code></pre>
<p>Profesor:</p>
<pre><code>      - Carlos Cavieres</code></pre>
<p>Integrantes:</p>
<pre><code>      - Meboly Vega
      
      - Vicente Román
      
      - Luis Gaete
      
      - Felipe Ugalde</code></pre>
<div style="page-break-after: always;">
<div style="page-break-after: always;">

</div>
<section id="introducción-librerias-y-paquetes-a-instalar" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción Librerias y Paquetes a instalar</h1>
<p>El presente informe muestra ejercicios relacionados con ocho activos financieros vistos durante el semestre en la asignatura. El diseño del informe se realizó mediante el motor de Quarto a través de RStudio, donde a su vez se trabajó con el lenguaje de programación R. A continuación (chunk no visible en el informe), se ejecutan las líneas de código correspondientes a la base de funcionamiento del script (instalación de paquetes y librerías necesarias).</p>
<blockquote class="blockquote">
<p><strong>Nota:</strong> Visual Studio Code es capaz de generar un informe a través del código mediante <strong>Ctrl+E</strong> y <strong>Ctrl+Shift+K</strong> (Previsualiza el documento); En caso de que ello no funcione, dentro de Github se encuentra el HTLM siendo este https://vicenteromausach.github.io/ActivosFinancierosF3/ . de todas maneras se recomienda la ejecución y renderizado en RStudio (tanto en R como en Python) mediante el botón <strong>RENDER</strong> ubicado en la cinta de opciones del archivo .qmd</p>
</blockquote>
</section>
<section id="activo-acciones" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Activo: Acciones</h1>
<p><strong>Definición</strong></p>
<p>Las <strong>acciones</strong> son títulos de propiedad que otorgan a su poseedor una participación proporcional en el capital y en los flujos futuros (dividendos) de una empresa.<br>
El valor teórico de una acción se obtiene descontando al presente los dividendos esperados y, de ser necesario, un valor terminal.</p>
<section id="ejemplo-clases" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="ejemplo-clases"><span class="header-section-number">2.1</span> Ejemplo (Clases)</h2>
<p>La empresa <strong>A</strong> pagará durante los próximos tres años dividendos de $20, $10 y $60.<br>
A partir del cuarto año, los dividendos crecerán indefinidamente al <strong>8 %</strong> anual.</p>
<p>La empresa <strong>B</strong> va a pagar un dividendo de $10 y este crecerá a una tasa constante del <strong>12 %</strong> anual.</p>
<p>La tasa de descuento de mercado es <strong>15 %</strong>.<br>
¿Cuál es el valor actual de la acción de cada empresa?</p>
<p><strong>Fórmulas</strong></p>
<p><strong>Modelo de Gordon‑Shapiro (crecimiento constante)</strong></p>
<p><span class="math display">\[
P_0 = \frac{D_1}{r - g}
\]</span></p>
<p><strong>Modelo de dos etapas (crecimiento no constante seguido de crecimiento perpetuo)</strong></p>
<p><span class="math display">\[
P_0 \;=\; \sum_{t=1}^{t} \frac{D_t}{(1+r)^{n}}
\;+\;
\frac{D_n\,(1+g)}{(r-g)\,(1+r)^{n}}
\]</span></p>
<p>D_t: dividendo en el año t<br>
r: tasa de descuento<br>
g: tasa de crecimiento<br>
n: último año de la etapa explícita</p>
</section>
<section id="código-r" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="código-r"><span class="header-section-number">2.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>r  <span class="ot">&lt;-</span> <span class="fl">0.15</span> <span class="co"># tasa de descuento</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Empresa A</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">&lt;-</span> <span class="dv">20</span>; D2 <span class="ot">&lt;-</span> <span class="dv">10</span>; D3 <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="co"># dividendos</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>gA <span class="ot">&lt;-</span> <span class="fl">0.08</span> <span class="co"># crecimiento perpetuo</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>pv_divs_A <span class="ot">&lt;-</span> D1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r) <span class="sc">+</span> D2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> D3<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">^</span><span class="dv">3</span> <span class="co">#Fórmula </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>terminal_A <span class="ot">&lt;-</span> D3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>gA)<span class="sc">/</span>(r <span class="sc">-</span> gA)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>pv_term_A  <span class="ot">&lt;-</span> terminal_A<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>P0_A <span class="ot">&lt;-</span> pv_divs_A <span class="sc">+</span> pv_term_A</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Empresa B</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># dividendo recién pagado</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>gB <span class="ot">&lt;-</span> <span class="fl">0.12</span>  <span class="co">#tasa constante</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>D1_B <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>P0_B <span class="ot">&lt;-</span> D1_B<span class="sc">/</span>(r <span class="sc">-</span> gB) <span class="co">#modelo gordon-shapiro</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="tabla-de-resultados"><span class="header-section-number">2.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">empresa =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">precio_actual =</span> <span class="fu">c</span>(<span class="fu">round</span>(P0_A, <span class="dv">2</span>), <span class="fu">round</span>(P0_B, <span class="dv">2</span>)))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res, <span class="at">caption =</span> <span class="st">"Valor presente estimado de cada acción"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Valor presente estimado de cada acción</caption>
<thead>
<tr class="header">
<th style="text-align: left;">empresa</th>
<th style="text-align: right;">precio_actual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">673.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">333.33</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráfico" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="gráfico"><span class="header-section-number">2.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">161</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># numero de dias bursatiles simulados</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">252</span> <span class="co"># tamano del paso temporal en años (1 dia bursatil)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="co"># riesgo anual supuesto</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rw_price <span class="ot">&lt;-</span> <span class="cf">function</span>(P0, mu, sigma, n, dt) { </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">c</span>(P0, P0 <span class="sc">*</span> <span class="fu">cumprod</span>(<span class="fu">exp</span>((mu <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>dt <span class="sc">+</span> sigma<span class="sc">*</span>eps))) </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>path }</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>price_A <span class="ot">&lt;-</span> <span class="fu">rw_price</span>(P0_A, gA, sigma, n, dt) <span class="co"># simula precios para la empresa A</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>price_B <span class="ot">&lt;-</span> <span class="fu">rw_price</span>(P0_B, gB, sigma, n, dt) <span class="co"># para la empresa B</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(price_A, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(price_A, price_B)),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"dias"</span>, <span class="at">ylab =</span> <span class="st">"precio simulado"</span>, <span class="at">main =</span> <span class="st">"Random Walk de Precios"</span>) </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(price_B, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Empresa A"</span>, <span class="st">"Empresa B"</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="resultado-y-conclusión"><span class="header-section-number">2.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Precio estimado de las acciones</strong></p>
<ul>
<li>Empresa A: $673.08</li>
<li>Empresa B: $333.33</li>
</ul></li>
<li><p><strong>Interpretación</strong></p>
<ul>
<li>La acción <strong>A</strong> vale más debido al gran dividendo explícito de $60 y al crecimiento perpetuo del 8 %.</li>
<li>La acción <strong>B</strong> depende íntegramente del crecimiento constante del 12 %, partiendo de un dividendo menor.</li>
<li>El gráfico muestra trayectorias simuladas: mayores pendientes medias reflejan mayores tasas de crecimiento esperadas, pero ambas series exhiben volatilidad; el inversionista debe ponderar riesgo y retorno antes de decidir.</li>
</ul></li>
</ul>
</section>
</section>
<section id="activo-bonos" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Activo: Bonos</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>bono</strong> es un instrumento de deuda que otorga al tenedor el derecho a recibir pagos de cupón periódicos y la devolución del valor nominal en la fecha de vencimiento.<br>
El precio de un bono corresponde al valor presente de esos flujos de efectivo descontados a la tasa de rendimiento exigida por el mercado.</p>
<section id="ejemplo-clases-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ejemplo-clases-1"><span class="header-section-number">3.1</span> Ejemplo (Clases)</h2>
<p>Un bono con valor nominal de <strong>$1 000</strong> paga cupones anuales de <strong>10 %</strong> durante <strong>10 años</strong>.<br>
Calcule el precio del bono para tres escenarios de tasas de mercado:</p>
<ol type="1">
<li><strong>10%</strong><br>
</li>
<li><strong>12%</strong><br>
</li>
<li><strong>8%</strong></li>
</ol>
<p><strong>Fórmulas</strong></p>
<p><strong>Valor presente del bono</strong></p>
<p><span class="math display">\[ P_0 \;=\; \sum_{t=1}^{n} \frac{C}{(1+r)^{t}} \;+\; \frac{F}{(1+r)^{n}} \]</span> donde</p>
<p>C: tasa cupón<br>
F: valor nominal<br>
n: número de periodos hasta el vencimiento<br>
r: tasa de rendimiento de mercado</p>
<p>Se rescribio la Fórmula de la siguiente manera:</p>
<p><span class="math display">\[
P \;=\;I\!\left[\frac{(1+i)^{n}-1}{i(1+i)^{n}}\right]\;+\;\frac{VN}{(1+i)^{n}}
\]</span> donde<br>
I = cupón anual&nbsp; i = tasa de mercado&nbsp; n = número de períodos&nbsp; VN = valor nominal del bono<br>
</p>
</section>
<section id="código-r-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="código-r-1"><span class="header-section-number">3.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parámetros del bono</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>vn  <span class="ot">&lt;-</span> <span class="dv">1000</span>        <span class="co"># valor nominal</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>c   <span class="ot">&lt;-</span> <span class="fl">0.10</span>        <span class="co"># tasa cupón </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>n   <span class="ot">&lt;-</span> <span class="dv">10</span>          <span class="co"># años al vencimiento</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>I   <span class="ot">&lt;-</span> vn <span class="sc">*</span> c      <span class="co"># cupón anual </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tasas de mercado a evaluar</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>tasas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.12</span>, <span class="fl">0.08</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># función de valoración </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>precio_bono <span class="ot">&lt;-</span> <span class="cf">function</span>(i, I, vn, n) {</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  pv_cupones   <span class="ot">&lt;-</span> I <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">+</span> i)<span class="sc">^</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (i <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> i)<span class="sc">^</span>n)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  pv_principal <span class="ot">&lt;-</span> vn <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> i)<span class="sc">^</span>n</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  pv_cupones <span class="sc">+</span> pv_principal}</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>precios <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tasas, precio_bono, <span class="at">I =</span> I, <span class="at">vn =</span> vn, <span class="at">n =</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-1" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="tabla-de-resultados-1"><span class="header-section-number">3.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>res_bono <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rendimiento =</span> <span class="fu">c</span>(<span class="st">"10 %"</span>, <span class="st">"12 %"</span>, <span class="st">"8 %"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">precio      =</span> <span class="fu">round</span>(precios, <span class="dv">2</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res_bono, <span class="at">caption =</span> <span class="st">"Precio del bono para distintos rendimientos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Precio del bono para distintos rendimientos</caption>
<thead>
<tr class="header">
<th style="text-align: left;">rendimiento</th>
<th style="text-align: right;">precio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">10 %</td>
<td style="text-align: right;">1000.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">12 %</td>
<td style="text-align: right;">887.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8 %</td>
<td style="text-align: right;">1134.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráfico-1" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="gráfico-1"><span class="header-section-number">3.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>precio_bono <span class="ot">&lt;-</span> <span class="cf">function</span>(yield, cup, vn, n) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  I  <span class="ot">&lt;-</span> cup <span class="sc">*</span> vn</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  pv_coupons   <span class="ot">&lt;-</span> I <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">+</span> yield)<span class="sc">^</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (yield <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> yield)<span class="sc">^</span>n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  pv_principal <span class="ot">&lt;-</span> vn <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> yield)<span class="sc">^</span>n</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  pv_coupons <span class="sc">+</span> pv_principal}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Rendimiento histórico del US treasury a 10 años (tasa anual, ya en %)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">"DGS10"</span>, <span class="at">src =</span> <span class="st">"FRED"</span>)          <span class="co"># serie</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DGS10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>yield_xts <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(DGS10) <span class="sc">/</span> <span class="dv">100</span>          <span class="co"># pasar a decimal</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Supuesto de que es un bono cupón 3%, 10 años</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>cup_real   <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>vn         <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>n_real     <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#precio diario</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>price_real <span class="ot">&lt;-</span> <span class="fu">xts</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">precio_bono</span>(<span class="fu">coredata</span>(yield_xts), cup_real, vn, n_real),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="fu">index</span>(yield_xts))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico!</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(price_real) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Precio implícito de un bono cupón 3%, 10 años</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">          basado en el Treasury yield 10Y (FRED)"</span>) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"precio ($)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-1" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="resultado-y-conclusión-1"><span class="header-section-number">3.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Precio calculado</strong></p>
<ul>
<li>Con rendimiento <strong>10%</strong> $1000 (a la par).</li>
<li>Con rendimiento <strong>12%</strong> $887 (con <em>descuento</em>).</li>
<li>Con rendimiento <strong>8%</strong> $1134.2 (con <em>prima</em>).</li>
</ul></li>
<li><p><strong>Interpretación</strong></p>
<ul>
<li>Si la tasa cupón es igual a la tasa de mercado (10 %), el bono se vende a su valor nominal.</li>
<li>Cuando el rendimiento exigido sube a 12 %, el bono se valora <strong>por debajo</strong> de la par (descuento) porque sus cupones resultan poco atractivos.</li>
<li>A un rendimiento de 8 % el bono se valora <strong>por encima</strong> de la par (prima) ya que sus cupones superan la rentabilidad ofrecida por el mercado.</li>
</ul></li>
</ul>
</section>
</section>
<section id="activo-forward-sobre-tipo-de-cambio" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Activo: Forward sobre tipo de cambio</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>forward</strong> es un contrato a plazo que obliga a las partes a intercambiar un activo (en este caso la divisa) en una fecha futura a un precio pactado hoy.<br>
Para divisas, el <strong>precio forward</strong> se determina por la paridad de intereses entre las dos monedas: el tipo de cambio spot ajustado por las tasas de interés de cada país durante el plazo acordado.</p>
<section id="ejemplo-clases-2" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="ejemplo-clases-2"><span class="header-section-number">4.1</span> Ejemplo (Clases)</h2>
<p>Un importador necesita <strong>1.000.000 USD</strong> dentro de <strong>90 días</strong> para pagar mercadería.<br>
Los datos de mercado son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spot compra (CLP/USD)</td>
<td>740</td>
</tr>
<tr class="even">
<td>Spot venta (CLP/USD)</td>
<td>750</td>
</tr>
<tr class="odd">
<td>Tasa CLP colocación (3 meses)</td>
<td>0,9% anual</td>
</tr>
<tr class="even">
<td>Tasa CLP captación (3 meses)</td>
<td>0,8% anual</td>
</tr>
<tr class="odd">
<td>Tasa USD captación (3 meses)</td>
<td>2,3% anual</td>
</tr>
<tr class="even">
<td>Tasa USD colocación (3 meses)</td>
<td>2,4% anual</td>
</tr>
</tbody>
</table>
<p>El importador pacta un <strong>forward de compra</strong> (él compra USD a futuro).<br>
¿Qué tipo de cambio forward deberá pagar y cuál será el costo total en pesos?</p>
<p><strong>Fórmulas</strong></p>
<p><strong>Paridad descubierta de intereses (compra de USD a plazo)</strong></p>
<p><span class="math display">\[F = S_{\text{compra}}
      \,\frac{1 + r_{\text{CLP, col}}\,\dfrac{n}{30}}
             {1 + r_{\text{USD, cap}}\,\dfrac{n}{360}}\]</span></p>
<dl>
<dt>: F: tipo de cambio forward (CLP/USD)</dt>
<dd>
<p>S_compra: tipo de cambio spot de compra (CLP/USD)</p>
</dd>
<dd>
<p>r_CLP,col: tasa de colocación en CLP</p>
</dd>
<dd>
<p>r_USD,cap: tasa de captación en USD</p>
</dd>
<dd>
<p>n: días al vencimiento</p>
</dd>
</dl>
</section>
<section id="código-r-2" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="código-r-2"><span class="header-section-number">4.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>spot_compra <span class="ot">&lt;-</span> <span class="dv">740</span>      <span class="co"># CLP por USD</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>r_clp_col   <span class="ot">&lt;-</span> <span class="fl">0.009</span>    <span class="co"># 0,9 % anual</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>r_usd_cap   <span class="ot">&lt;-</span> <span class="fl">0.023</span>    <span class="co"># 2,3 % anual</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>n_dias      <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>usd_neces   <span class="ot">&lt;-</span> <span class="fl">1e6</span>      <span class="co"># 1 000 000 USD</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fórmula del forward de compra</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>F_forward <span class="ot">&lt;-</span> spot_compra <span class="sc">*</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> r_clp_col <span class="sc">*</span> (n_dias <span class="sc">/</span> <span class="dv">30</span>)) <span class="sc">/</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> r_usd_cap <span class="sc">*</span> (n_dias <span class="sc">/</span> <span class="dv">360</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># costo total en CLP si se cubre</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>costo_hedged <span class="ot">&lt;-</span> usd_neces <span class="sc">*</span> F_forward</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-2" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="tabla-de-resultados-2"><span class="header-section-number">4.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>res_forward <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">item   =</span> <span class="fu">c</span>(<span class="st">"tipo de cambio forward"</span>, <span class="st">"costo total (CLP)"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">valor  =</span> <span class="fu">c</span>(<span class="fu">round</span>(F_forward, <span class="dv">2</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">format</span>(<span class="fu">round</span>(costo_hedged, <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res_forward, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"resultado"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Resultado de la operación forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Resultado de la operación forward</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tipo de cambio forward</td>
<td style="text-align: left;">755.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">costo total (CLP)</td>
<td style="text-align: left;">755,635,098</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráfico-2" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="gráfico-2"><span class="header-section-number">4.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>S_T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">700</span>, <span class="dv">800</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>costo_unhedged <span class="ot">&lt;-</span> usd_neces <span class="sc">*</span> S_T</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#curva de costos con y sin cobertura</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S_T, costo_unhedged <span class="sc">/</span> <span class="fl">1e9</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"spot al vencimiento (CLP/USD)"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"costo (miles de millones de CLP)"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Costo con y sin cobertura forward"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#costo fijo</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> costo_hedged <span class="sc">/</span> <span class="fl">1e9</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#línea segmentada</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> F_forward, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)  <span class="co"># línea vertical</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># punto de intersección (opcional, para resaltarlo)</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(F_forward,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>       costo_hedged <span class="sc">/</span> <span class="fl">1e9</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># etiqueta del precio forward</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(F_forward,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>     costo_hedged <span class="sc">/</span> <span class="fl">1e9</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"CLP = "</span>, <span class="fu">round</span>(F_forward, <span class="dv">2</span>)),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"sin cobertura"</span>, <span class="st">"con forward (costo fijo)"</span>, <span class="st">"F forward"</span>),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd   =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty   =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col   =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="st">"darkred"</span>),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty   =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-2" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="resultado-y-conclusión-2"><span class="header-section-number">4.4</span> Resultado y Conclusión</h2>
<ul>
<li><strong>Tipo de cambio forward</strong> pactado: <strong>$755,64 CLP/USD</strong></li>
<li><strong>Costo total</strong> por 1.000.000 USD: <strong>$755.640.000 CLP</strong></li>
</ul>
<p><strong>Interpretación</strong></p>
<ul>
<li>Con el forward, el importador fija su desembolso en 755,64 CLP por dólar; si el spot en 90 días supera ese valor, la cobertura le ahorra dinero.</li>
<li>Si el spot resulta menor, pagará relativamente de más, pero evita la incertidumbre.</li>
<li>La gráfica muestra que el costo sin cobertura crece línea recta con el spot, mientras el costo cubierto se mantiene fijo; esto ilustra la eliminación del riesgo cambiario.</li>
</ul>
</section>
</section>
<section id="activo-fra-forward-rate-agreement" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Activo: FRA (Forward Rate Agreement)</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>FRA</strong> es un acuerdo a plazo que fija hoy el tipo de interés de un préstamo o depósito que comenzará en una fecha futura.<br>
La liquidación se basa en la diferencia entre la tasa de mercado al inicio del periodo protegido y la tasa acordada en el contrato, aplicada al nominal y descontada al valor presente.</p>
<section id="ejemplo-betzuen-2016" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="ejemplo-betzuen-2016"><span class="header-section-number">5.1</span> Ejemplo (Betzuen, (2016))</h2>
<p>Un empresario trata de asegurarse, para dentro de 6 meses, un préstamo a 3 meses, al <strong>3,5%</strong> de interés. Adopta una posición compradora de un <strong>FRA(6/9)</strong>, para un valor nominal de <strong>100.000€</strong> y un tipo garantizado del <strong>3,5%</strong>. El periodo de garantía es de <strong>90 días</strong>. Consideremos dos situaciones totalmente contrarias y comprobemos que se alcanza el objetivo perseguido:</p>
<p><strong>I)</strong> Que al cabo de 6 meses el tipo de interés del mercado, por ejemplo, Euribor a 3 meses, se sitúe en el <strong>4%</strong>.</p>
<p><strong>II)</strong> Que al cabo de 6 meses el tipo de mercado se sitúe en el <strong>3%</strong>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Escenario</th>
<th>Tasa de mercado (i_m)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4,0%</td>
</tr>
<tr class="even">
<td>B</td>
<td>3,0%</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
L = \frac{N\,(i_m - i_{FRA})\,\dfrac{t_2}{360}}
         {1 + i_m\,\dfrac{t_2}{360}}
\]</span></p>
<p>donde</p>
<ul>
<li>L: es el pago neto (positivo para el comprador si i_m &gt; i_FRA.<br>
</li>
<li>N: es el nominal del contrato.<br>
</li>
<li>i_m: es la tasa de mercado observada al inicio del periodo protegido.<br>
</li>
<li>i_FRA: es la tasa pactada en el FRA.<br>
</li>
<li>t_2: es la duración del periodo protegido en días.</li>
</ul>
</section>
<section id="código-r-3" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="código-r-3"><span class="header-section-number">5.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parametros</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>N       <span class="ot">&lt;-</span> <span class="fl">1e5</span>   <span class="co"># nominal (€)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>i_FRA   <span class="ot">&lt;-</span> <span class="fl">0.035</span>   <span class="co"># tasa FRA garantizada</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>t2      <span class="ot">&lt;-</span> <span class="dv">90</span>     <span class="co"># días del período (90 = 3 meses)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># escenarios de mercado</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>esc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Escenario =</span> <span class="fu">c</span>(<span class="st">"I"</span>, <span class="st">"II"</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">i_m       =</span> <span class="fu">c</span>(<span class="fl">0.04</span>, <span class="fl">0.03</span>))   <span class="co"># 4 % y 3 %</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>liquidacion <span class="ot">&lt;-</span> <span class="cf">function</span>(i_m) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  ( (i_m <span class="sc">-</span> i_FRA) <span class="sc">*</span> N <span class="sc">*</span> t2<span class="sc">/</span><span class="dv">360</span> ) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> i_m <span class="sc">*</span> t2<span class="sc">/</span><span class="dv">360</span>)}</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>interes_mercado <span class="ot">&lt;-</span> <span class="cf">function</span>(i_m) {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">*</span> i_m <span class="sc">*</span> t2<span class="sc">/</span><span class="dv">360</span>}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  Cálculos</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>esc<span class="sc">$</span>L_liq        <span class="ot">&lt;-</span> <span class="fu">liquidacion</span>(esc<span class="sc">$</span>i_m)<span class="co"># € cobrados (+) o pagados (‑)</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>esc<span class="sc">$</span>Interés_mkt  <span class="ot">&lt;-</span> <span class="fu">interes_mercado</span>(esc<span class="sc">$</span>i_m)<span class="co"># intereses al tipo de mercado</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>esc<span class="sc">$</span>Costo_neto   <span class="ot">&lt;-</span> esc<span class="sc">$</span>Interés_mkt <span class="sc">-</span> esc<span class="sc">$</span>L_liq <span class="co"># coste neto después de FRA</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>esc<span class="sc">$</span>Tasa_efectiva<span class="ot">&lt;-</span> esc<span class="sc">$</span>Costo_neto <span class="sc">/</span> (N <span class="sc">*</span> t2<span class="sc">/</span><span class="dv">360</span>)<span class="co"># tasa efectivamente pagada</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>esc<span class="sc">$</span>Tasa_efectiva_pct <span class="ot">&lt;-</span> <span class="fu">round</span>(esc<span class="sc">$</span>Tasa_efectiva<span class="sc">*</span><span class="dv">100</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-3" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="tabla-de-resultados-3"><span class="header-section-number">5.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  esc <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">i_m           =</span> scales<span class="sc">::</span><span class="fu">percent</span>(i_m , <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">L_liq         =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(L_liq ,<span class="dv">2</span>)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      Interés<span class="at">_mkt   =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(Interés_mkt,<span class="dv">2</span>)),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Costo_neto    =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(Costo_neto,<span class="dv">2</span>)),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Tasa efectiva</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(Tasa_efectiva_pct, <span class="st">"%"</span>)),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Liquidación del FRA y coste efectivo del préstamo (comprador de FRA)"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">align   =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Liquidación del FRA y coste efectivo del préstamo (comprador de FRA)</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 19%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Escenario</th>
<th style="text-align: center;">i_m</th>
<th style="text-align: center;">L_liq</th>
<th style="text-align: center;">Interés_mkt</th>
<th style="text-align: center;">Costo_neto</th>
<th style="text-align: center;">Tasa_efectiva</th>
<th style="text-align: center;">Tasa_efectiva_pct</th>
<th style="text-align: center;">Tasa efectiva</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">I</td>
<td style="text-align: center;">4.0%</td>
<td style="text-align: center;">124</td>
<td style="text-align: center;">1,000</td>
<td style="text-align: center;">876.2</td>
<td style="text-align: center;">0.0350495</td>
<td style="text-align: center;">3.505</td>
<td style="text-align: center;">3.505%</td>
</tr>
<tr class="even">
<td style="text-align: center;">II</td>
<td style="text-align: center;">3.0%</td>
<td style="text-align: center;">-124</td>
<td style="text-align: center;">750</td>
<td style="text-align: center;">874.1</td>
<td style="text-align: center;">0.0349628</td>
<td style="text-align: center;">3.496</td>
<td style="text-align: center;">3.496%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráfico-3" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="gráfico-3"><span class="header-section-number">5.3</span> Gráfico</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rango de tasas y liquidación</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>rango  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.06</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>payoff <span class="ot">&lt;-</span> <span class="fu">liquidacion</span>(rango)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico base (línea naranja)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rango<span class="sc">*</span><span class="dv">100</span>, payoff,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"orange"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Tasa de mercado (%)"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"EUR"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Comprador de FRA – beneficio según la tasa de mercado"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># líneas de referencia</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>,          <span class="at">lty =</span> <span class="dv">2</span>)             <span class="co"># eje horizontal</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> i_FRA<span class="sc">*</span><span class="dv">100</span>,  <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>)<span class="co"># tasa garantizada (3,5 %)</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- área positiva (azul) ----------------------------------------------</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>esc_pos <span class="ot">&lt;-</span> esc <span class="sc">|&gt;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(L_liq <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(esc_pos, <span class="dv">1</span>, \(row){</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  i_m   <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(row[<span class="st">"i_m"</span>])</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  L_liq <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(row[<span class="st">"L_liq"</span>])</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(i_FRA<span class="sc">*</span><span class="dv">100</span>, i_m<span class="sc">*</span><span class="dv">100</span>, i_m<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,          <span class="dv">0</span>,        L_liq),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.35</span>), <span class="at">border =</span> <span class="cn">NA</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puntos y etiquetas de ambos escenarios (opcional)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(esc, {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(i_m<span class="sc">*</span><span class="dv">100</span>, L_liq, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(i_m<span class="sc">*</span><span class="dv">100</span>, L_liq,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"Rm = "</span>, i_m<span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">pos =</span> <span class="fu">ifelse</span>(i_m <span class="sc">&gt;</span> i_FRA, <span class="dv">4</span>, <span class="dv">2</span>))})</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># leyenda: solo muestra la línea gris de la tasa asegurada</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="st">"Tasa asegurada 3,5&nbsp;%"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd   =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">col   =</span> <span class="st">"gray"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty   =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/curva-fra-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>liquidacion_vend <span class="ot">&lt;-</span> <span class="cf">function</span>(i_m){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">liquidacion</span>(i_m)}</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>payoff_v <span class="ot">&lt;-</span> <span class="fu">liquidacion_vend</span>(rango)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rango<span class="sc">*</span><span class="dv">100</span>, payoff_v,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"orange"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Tasa de mercado (%)"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"EUR"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Vendedor de FRA – beneficio según la tasa de mercado"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>,         <span class="at">lty =</span> <span class="dv">2</span>)             <span class="co"># eje horizontal</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> i_FRA<span class="sc">*</span><span class="dv">100</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="co"># tasa garantizada 3,5 %</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>esc_v <span class="ot">&lt;-</span> esc <span class="sc">|&gt;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">liquidacion_vend</span>(i_m) <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># escenarios con ganancia</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(esc_v, <span class="dv">1</span>, \(row){</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  i_m   <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(row[<span class="st">"i_m"</span>])</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  L_v   <span class="ot">&lt;-</span> <span class="fu">liquidacion_vend</span>(i_m)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vértices: (i_FRA,0) – (i_m,0) – (i_m,L_v)</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(i_FRA<span class="sc">*</span><span class="dv">100</span>, i_m<span class="sc">*</span><span class="dv">100</span>, i_m<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,          <span class="dv">0</span>,        L_v),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.35</span>), <span class="at">border =</span> <span class="cn">NA</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puntos y etiquetas (opcional)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(esc, {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(i_m<span class="sc">*</span><span class="dv">100</span>, <span class="fu">liquidacion_vend</span>(i_m), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(i_m<span class="sc">*</span><span class="dv">100</span>, <span class="fu">liquidacion_vend</span>(i_m),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"Rm = "</span>, i_m<span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">pos =</span> <span class="fu">ifelse</span>(i_m <span class="sc">&lt;</span> i_FRA, <span class="dv">4</span>, <span class="dv">2</span>))})</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># leyenda mínima</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="st">"Tasa asegurada 3,5&nbsp;%"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd   =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty   =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-3" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="resultado-y-conclusión-3"><span class="header-section-number">5.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Liquidación del FRA (comprador)</strong></p>
<ul>
<li>EscenarioA (4%): <strong>123,76€</strong> recibe el comprador.</li>
<li>EscenarioB (3%): <strong>–124,07€</strong> paga el comprador (recibe el vendedor).</li>
</ul></li>
</ul>
<p><strong>Interpretación</strong></p>
<ul>
<li>aunque el Euribor suba a 4% el empresario paga efectivamente 3,5% de ínteres.</li>
<li>aunque el Euribor baje a 3$ el empresario paga efectivamente 3,5% de ínteres.</li>
</ul>
</section>
</section>
<section id="activo-futuro-sobre-índice-bursátil" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Activo: Futuro sobre índice bursátil</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>futuro sobre índice</strong> es un contrato estandarizado que obliga a las partes a intercambiar, en una fecha futura, el valor de un índice bursátil al precio pactado hoy.<br>
El precio teórico se obtiene ajustando el nivel spot del índice por la diferencia entre la tasa libre de riesgo y el rendimiento por dividendos esperados durante la vida del contrato.</p>
<section id="ejemplo-hull-2009" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="ejemplo-hull-2009"><span class="header-section-number">6.1</span> Ejemplo (Hull (2009))</h2>
<p>Se pacta hoy <strong>31 de julio</strong> un futuro sobre un índice cuyo nivel spot es <strong>1.300USD</strong>.<br>
Datos:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 61%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Parámetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tasa libre de riesgo (continua)</td>
<td>9 % anual</td>
</tr>
<tr class="even">
<td>Meses con dividendos de 5 %</td>
<td>febrero, mayo, agosto, noviembre</td>
</tr>
<tr class="odd">
<td>Meses restantes dividendos de 2 %</td>
<td>enero, marzo, abril, junio, julio, septiembre, octubre, diciembre</td>
</tr>
<tr class="even">
<td>Vencimiento del contrato</td>
<td>31 de diciembre (5 meses)</td>
</tr>
</tbody>
</table>
<p>Durante los <strong>5 meses</strong> de vida del futuro (agosto–diciembre) los rendimientos por dividendos son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mes</th>
<th>q</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>agosto</td>
<td>5 %</td>
</tr>
<tr class="even">
<td>septiembre</td>
<td>2 %</td>
</tr>
<tr class="odd">
<td>octubre</td>
<td>2 %</td>
</tr>
<tr class="even">
<td>noviembre</td>
<td>5 %</td>
</tr>
<tr class="odd">
<td>diciembre</td>
<td>2 %</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
\bar q = \frac{1}{m}\sum_{i=1}^{m} q_i
\]</span></p>
<p><span class="math display">\[
F_0 = S_0 \, e^{(r - \bar q)\,t}
\]</span></p>
<p>donde</p>
<ul>
<li>q: es la tasa promedio de dividendos durante la vida del contrato.<br>
</li>
<li>S_0: es el nivel spot del índice hoy.<br>
</li>
<li>r: es la tasa libre de riesgo con capitalización continua.<br>
</li>
<li>t: es el tiempo al vencimiento en años.<br>
</li>
<li>F_0: es el precio teórico del futuro.</li>
</ul>
</section>
<section id="código-r-4" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="código-r-4"><span class="header-section-number">6.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>S0 <span class="ot">&lt;-</span> <span class="dv">1300</span>          <span class="co"># nivel spot</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>r  <span class="ot">&lt;-</span> <span class="fl">0.09</span>          <span class="co"># tasa libre de riesgo</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>t  <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">12</span>          <span class="co"># 5 meses expresados en años</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rendimientos por dividendos de los 5 meses relevantes</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>q_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.02</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>q_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(q_vec)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># precio teórico del futuro</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>F0 <span class="ot">&lt;-</span> S0 <span class="sc">*</span> <span class="fu">exp</span>((r <span class="sc">-</span> q_bar) <span class="sc">*</span> t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-4" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="tabla-de-resultados-4"><span class="header-section-number">6.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>res_fut <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"nivel spot (S0)"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tasa libre de riesgo (r)"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tasa dividendo promedio (q̄)"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"plazo (años)"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"precio futuro (F0)"</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">valor =</span> <span class="fu">c</span>(<span class="dv">1300</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"9 %"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"3,2 %"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(t, <span class="dv">4</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(F0, <span class="dv">2</span>)))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res_fut, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"valor"</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Cálculo del precio futuro"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Cálculo del precio futuro</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nivel spot (S0)</td>
<td style="text-align: left;">1300</td>
</tr>
<tr class="even">
<td style="text-align: left;">tasa libre de riesgo (r)</td>
<td style="text-align: left;">9 %</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tasa dividendo promedio (q̄)</td>
<td style="text-align: left;">3,2 %</td>
</tr>
<tr class="even">
<td style="text-align: left;">plazo (años)</td>
<td style="text-align: left;">0.4167</td>
</tr>
<tr class="odd">
<td style="text-align: left;">precio futuro (F0)</td>
<td style="text-align: left;">1331.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráficos" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="gráficos"><span class="header-section-number">6.3</span> Gráficos</h2>
<p>Gráfico 1 visualización de Futuros y precio Spot</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#simbolos</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sym_cash   <span class="ot">&lt;-</span> <span class="st">"^GSPC"</span>   <span class="co"># S&amp;P 500 spot</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sym_future <span class="ot">&lt;-</span> <span class="st">"ES=F"</span>    <span class="co"># Futuro continuo E-mini </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>desde      <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="fu">years</span>(<span class="dv">2</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># getSymbols devuelve un objeto xts </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>cash_xts <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(sym_cash,   <span class="at">src =</span> <span class="st">"yahoo"</span>, <span class="at">from =</span> desde,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>fut_xts  <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(sym_future, <span class="at">src =</span> <span class="st">"yahoo"</span>, <span class="at">from =</span> desde,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ES=F contains missing values. Some functions will not work if objects
contain missing values in the middle of the series. Consider using na.omit(),
na.approx(), na.fill(), etc to remove or replace them.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cash_px <span class="ot">&lt;-</span> <span class="fu">Ad</span>(cash_xts)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>fut_px  <span class="ot">&lt;-</span> <span class="fu">Ad</span>(fut_xts)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(cash_px, fut_px, <span class="at">join =</span> <span class="st">"inner"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cash"</span>, <span class="st">"Future"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#rendimientos diarios</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cash_ret   =</span> <span class="dv">100</span> <span class="sc">*</span> (<span class="fu">log</span>(Cash)   <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(Cash))),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Future_ret =</span> <span class="dv">100</span> <span class="sc">*</span> (<span class="fu">log</span>(Future) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(Future))))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico de precios spot y los futuros del indice</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>df_norm <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cash_norm   =</span> <span class="dv">100</span> <span class="sc">*</span> Cash   <span class="sc">/</span> <span class="fu">first</span>(Cash),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Future_norm =</span> <span class="dv">100</span> <span class="sc">*</span> Future <span class="sc">/</span> <span class="fu">first</span>(Future)) <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Cash_norm, Future_norm) <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"Serie"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_norm, <span class="fu">aes</span>(Date, Valor, <span class="at">colour =</span> Serie)) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Índice (base = 100)"</span>, <span class="at">colour =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Cash_norm"</span>   <span class="ot">=</span> <span class="st">"steelblue"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Future_norm"</span> <span class="ot">=</span> <span class="st">"darkorange"</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels  =</span> <span class="fu">c</span>(<span class="st">"S&amp;P 500 spot"</span>, <span class="st">"Futuro E-mini"</span>)) <span class="sc">+</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/graf-fut-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Gráfico 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>F0 <span class="ot">&lt;-</span> F0                    </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>F_T <span class="ot">&lt;-</span> <span class="fu">seq</span>(F0 <span class="sc">-</span> <span class="dv">250</span>, F0 <span class="sc">+</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">1</span>)  </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>pay <span class="ot">&lt;-</span> F_T <span class="sc">-</span> F0           </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df_pay <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(F_T, pay)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(F_T, pay)) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> F0,  <span class="at">colour =</span> <span class="st">"grey55"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"#003399"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> F0, <span class="at">y =</span> <span class="dv">0</span>), <span class="at">colour =</span> <span class="st">"dodgerblue4"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> F0, <span class="at">y =</span> <span class="dv">10</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"q ≈ 1 331,8"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"dodgerblue4"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> F0 <span class="sc">-</span> <span class="dv">180</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">20</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> F0 <span class="sc">-</span> <span class="dv">100</span>, <span class="at">yend =</span> <span class="sc">-</span><span class="dv">80</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>),</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type   =</span> <span class="st">"closed"</span>),</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"firebrick"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> F0 <span class="sc">-</span> <span class="dv">190</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Pérdida</span><span class="sc">\n</span><span class="st">posición larga"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"firebrick"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> F0 <span class="sc">+</span> <span class="dv">180</span>, <span class="at">y =</span>  <span class="dv">20</span>,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> F0 <span class="sc">+</span> <span class="dv">100</span>, <span class="at">yend =</span>  <span class="dv">80</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>),</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type   =</span> <span class="st">"closed"</span>),</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"forestgreen"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> F0 <span class="sc">+</span> <span class="dv">190</span>, <span class="at">y =</span>  <span class="dv">10</span>,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Beneficio</span><span class="sc">\n</span><span class="st">posición larga"</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>(),</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks  =</span> <span class="fu">seq</span>(F0 <span class="sc">-</span> <span class="dv">250</span>, F0 <span class="sc">+</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks  =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posición Larga – Futuro sobre el índice"</span>,</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">x     =</span> <span class="st">"Precio del futuro al vencimiento (puntos del índice)"</span>,</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y     =</span> <span class="st">"Beneficio / Pérdida por contrato (puntos)"</span>) <span class="sc">+</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = F0, y = 0), colour = "dodgerblue4", size = 3): All aesthetics have length 1, but the data has 501 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-4" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="resultado-y-conclusión-4"><span class="header-section-number">6.4</span> Resultado y Conclusión</h2>
<p>El <strong>precio teórico</strong> del futuro con entrega el 31 de diciembre es <strong>$1.331,80USD</strong>.</p>
<ul>
<li>El gráfico 2 muestra que cuanto mayor sea el rendimiento esperado por dividendos, menor será el precio futuro, manteniendo constantes las demás variables.</li>
</ul>
</section>
</section>
<section id="activo-opción-call" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Activo: Opción Call</h1>
<p><strong>Definición</strong></p>
<p>Una <strong>call europea</strong> otorga al comprador el derecho (no la obligación) de comprar un activo subyacente a un <strong>precio de ejercicio</strong> (K) en la fecha de vencimiento.<br>
En un árbol binomial, el precio hoy se obtiene valorando los flujos terminales bajo probabilidad neutral al riesgo y descontándolos a la tasa libre de riesgo.</p>
<section id="ejemplo-clases-3" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="ejemplo-clases-3"><span class="header-section-number">7.1</span> Ejemplo (Clases)</h2>
<p>La acción del Banco de Chile está cotizando en la bolsa a <strong>10 pesos</strong>. Debido a la incertidumbre del mercado financiero, un inversionista supone que el precio podría <strong>aumentar o disminuir en un 20 %</strong> en los próximos <strong>2 años</strong>.</p>
<p>Datos adicionales:</p>
<ul>
<li>Prima de opción: <strong>1,15 pesos</strong></li>
<li>Paquete: <strong>100 acciones</strong></li>
<li>Precio de ejercicio (strike): <strong>8 pesos</strong> (K=8)</li>
<li>Tasa libre de riesgo anual (simple): <strong>11 %</strong></li>
</ul>
<p><strong>A)</strong> Evaluar cuándo se ejerce la opción.</p>
<p><strong>B)</strong> Calcular el precio de una <strong>CALL europea</strong> a 2años.</p>
<p>Datos del contrato:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parámetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tasa libre de riesgo (simple)</td>
<td>10 % anual</td>
</tr>
<tr class="even">
<td>Periodos hasta el vencimiento</td>
<td>2 años</td>
</tr>
<tr class="odd">
<td>Factor alza (u)</td>
<td>1,2</td>
</tr>
<tr class="even">
<td>Factor baja (d)</td>
<td>0,8</td>
</tr>
<tr class="odd">
<td>Precio strike (K)</td>
<td>$ 8</td>
</tr>
<tr class="even">
<td>Prima pagada</td>
<td>$ 1,15 por acción</td>
</tr>
<tr class="odd">
<td>Tamaño del lote</td>
<td>100 acciones</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
R = 1 + r
\]</span></p>
<p><span class="math display">\[
p = \frac{R - d}{u - d}
\]</span></p>
<p><span class="math display">\[
C = \frac{p\,C_{\text{up}} + (1-p)\,C_{\text{down}}}{R}
\]</span></p>
<p>donde</p>
<ul>
<li>R es el factor de capitalización libre de riesgo.<br>
</li>
<li>p es la probabilidad neutral al riesgo de un movimiento al alza.<br>
</li>
<li>C_up, (C_down son los valores de la opción en los nodos siguientes).</li>
</ul>
</section>
<section id="código-r-5" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="código-r-5"><span class="header-section-number">7.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parametros</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>S0   <span class="ot">&lt;-</span> <span class="dv">10</span>            <span class="co"># precio spot</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>K    <span class="ot">&lt;-</span> <span class="dv">8</span>             <span class="co"># strike</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>u    <span class="ot">&lt;-</span> <span class="fl">1.2</span>           <span class="co"># factor alza</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>d    <span class="ot">&lt;-</span> <span class="fl">0.8</span>           <span class="co"># factor baja</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>r    <span class="ot">&lt;-</span> <span class="fl">0.10</span>          <span class="co"># tasa libre de riesgo (simple)</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>R    <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> r         <span class="co"># factor de capitalizacion</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>n    <span class="ot">&lt;-</span> <span class="dv">2</span>             <span class="co"># pasos</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>premium <span class="ot">&lt;-</span> <span class="fl">1.15</span>       <span class="co"># prima por accion</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>lote    <span class="ot">&lt;-</span> <span class="dv">100</span>        <span class="co"># acciones en el paquete</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilidad neutral al riesgo</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (R <span class="sc">-</span> d) <span class="sc">/</span> (u <span class="sc">-</span> d)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># precios en el nodo final t = 2</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>Suu <span class="ot">&lt;-</span> S0 <span class="sc">*</span> u<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>Sud <span class="ot">&lt;-</span> S0 <span class="sc">*</span> u <span class="sc">*</span> d</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>Sdd <span class="ot">&lt;-</span> S0 <span class="sc">*</span> d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>Cuu <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Suu <span class="sc">-</span> K)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>Cud <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Sud <span class="sc">-</span> K)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>Cdd <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Sdd <span class="sc">-</span> K)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co"># retroceso a t = 1</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>Cu <span class="ot">&lt;-</span> (p <span class="sc">*</span> Cuu <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> Cud) <span class="sc">/</span> R</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>Cd <span class="ot">&lt;-</span> (p <span class="sc">*</span> Cud <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> Cdd) <span class="sc">/</span> R</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co"># precio presente de la call</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>C0 <span class="ot">&lt;-</span> (p <span class="sc">*</span> Cu <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> Cd) <span class="sc">/</span> R</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>C_paquete <span class="ot">&lt;-</span> C0 <span class="sc">*</span> lote</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla de escenarios para el beneficio neto al vencimiento</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>S_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">6</span>, <span class="dv">13</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>payoff  <span class="ot">&lt;-</span> <span class="fu">pmax</span>(S_range <span class="sc">-</span> K, <span class="dv">0</span>) <span class="sc">*</span> lote</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>net     <span class="ot">&lt;-</span> payoff <span class="sc">-</span> premium <span class="sc">*</span> lote</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>escen   <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">precio_final =</span> S_range,</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">payoff =</span> payoff,</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prima  =</span> <span class="sc">-</span>premium <span class="sc">*</span> lote,</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">beneficio =</span> net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-5" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="tabla-de-resultados-5"><span class="header-section-number">7.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(escen, <span class="dv">15</span>),</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Beneficio neto del paquete según el precio final"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Beneficio neto del paquete según el precio final</caption>
<thead>
<tr class="header">
<th style="text-align: right;">precio_final</th>
<th style="text-align: right;">payoff</th>
<th style="text-align: right;">prima</th>
<th style="text-align: right;">beneficio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-115</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-115</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-115</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-115</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-115</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-65</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">-15</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">135</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">185</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.5</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">235</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">285</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">335</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">-115</td>
<td style="text-align: right;">385</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="gráfico-4" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="gráfico-4"><span class="header-section-number">7.3</span> Gráfico</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S_range, net, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"precio de la acción al vencimiento (CLP)"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"beneficio neto del lote (CLP)"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Pay-off neto – CALL (paquete 100 acciones)"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>breakeven <span class="ot">&lt;-</span> K <span class="sc">+</span> premium                   </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(breakeven, <span class="dv">0</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(breakeven, <span class="dv">0</span>, <span class="st">"At The Money  (9,15)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>x_itm <span class="ot">&lt;-</span> <span class="dv">11</span>                                 </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>y_itm <span class="ot">&lt;-</span> <span class="fu">approx</span>(S_range, net, x_itm)<span class="sc">$</span>y    </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> x_itm <span class="sc">-</span> <span class="dv">1</span>, <span class="at">y0 =</span> y_itm <span class="sc">-</span> <span class="dv">40</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> x_itm <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y1 =</span> y_itm <span class="sc">-</span> <span class="dv">40</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"forestgreen"</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x_itm,  y_itm <span class="sc">-</span> <span class="dv">22</span>,  <span class="st">"In The Money"</span>, <span class="at">col =</span> <span class="st">"forestgreen"</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>x_otm <span class="ot">&lt;-</span> <span class="dv">7</span>                                </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>y_otm <span class="ot">&lt;-</span> <span class="fu">approx</span>(S_range, net, x_otm)<span class="sc">$</span>y     </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> x_otm <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y0 =</span> y_otm <span class="sc">+</span> <span class="dv">40</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> x_otm <span class="sc">-</span> <span class="dv">1</span>, <span class="at">y1 =</span> y_otm <span class="sc">+</span> <span class="dv">40</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x_otm,  y_otm <span class="sc">+</span> <span class="dv">22</span>, <span class="st">"Out The Money"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/graf-call-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-5" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="resultado-y-conclusión-5"><span class="header-section-number">7.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Se ejerce la opción</strong> cuando el precio al vencimiento sea <strong>mayor o igual a 8 CLP</strong> (el strike). Por debajo de ese nivel el payoff es cero y el comprador pierde únicamente la prima.</p></li>
<li><p><strong>Precio de la call europea (por acción)</strong>: <strong>$ 3,47</strong> <strong>Valor del paquete (100 acciones)</strong>: <strong>$ 347</strong></p></li>
</ul>
<p><em>La prima de 1,15 CLP representa el desembolso inicial; el comprador necesita que la acción cierre por encima de 9,15 CLP (strike + prima) para obtener ganancia neta.</em></p>
</section>
</section>
<section id="activo-uf" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Activo: UF</h1>
<p><strong>Definición</strong></p>
<p>La <strong>UF</strong> es una unidad indexada a la inflación chilena.<br>
Cada día se actualiza aplicando, de forma proporcional, la variación del IPC del mes anterior.<br>
Del <strong>10 de cada mes</strong> al <strong>9 del mes siguiente</strong> se utiliza el IPC publicado el día 8.</p>
<section id="ejemplo-clase" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="ejemplo-clase"><span class="header-section-number">8.1</span> Ejemplo (Clase)</h2>
<blockquote class="blockquote">
<p><strong>Objetivo</strong>&nbsp;–&nbsp;Estimar la UF del <strong>9 de agosto 2025</strong> a partir de la UF oficial del <strong>16 de junio 2025</strong> (UF = 39220,48).</p>
<p>IPC mayo&nbsp;=&nbsp;+0,2 %<br>
IPC junio&nbsp;=&nbsp;−0,4 %</p>
</blockquote>
<p>Los tramos que intervienen son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tramo</th>
<th>Días</th>
<th>IPC aplicado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>16 jun → 9 jul</td>
<td>23&nbsp;días&nbsp;(16 jun–9 jul)</td>
<td>0,2 % (mayo)</td>
</tr>
<tr class="even">
<td>10 jul → 9 ago</td>
<td>21&nbsp;días&nbsp;(10 jul–9 ago)</td>
<td>−0,4 % (junio)</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
\text{UF}_t = \text{UF}_{t-1}\;(1 + \text{IPC})^{\tfrac{T}{n}}
\]</span></p>
<p>donde</p>
<ul>
<li>T&nbsp;=&nbsp;número de días transcurridos dentro del periodo.<br>
</li>
<li>n&nbsp;=&nbsp;días del periodo completo (30 para junio, 31 para julio).</li>
</ul>
</section>
<section id="código-r-6" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="código-r-6"><span class="header-section-number">8.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos base</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>UF_ini   <span class="ot">&lt;-</span> <span class="fl">39230.48</span>      <span class="co"># UF al 16‑jun</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>ipc_mayo <span class="ot">&lt;-</span> <span class="fl">0.002</span>         <span class="co"># +0,2&nbsp;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ipc_jun  <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.004</span>        <span class="co"># –0,4&nbsp;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="dv">23</span>   ;  n1 <span class="ot">&lt;-</span> <span class="dv">30</span>    <span class="co"># 16‑jun → 9‑jul  (23 de 30 días de junio)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="dv">31</span>   ;  n2 <span class="ot">&lt;-</span> <span class="dv">31</span>    <span class="co"># 10‑jul → 9‑ago  (21 de 31 días de julio)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cálculo paso a paso</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>UF_9jul   <span class="ot">&lt;-</span> UF_ini <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> ipc_mayo)<span class="sc">^</span>(T1 <span class="sc">/</span> n1)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>UF_9ago   <span class="ot">&lt;-</span> UF_9jul <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> ipc_jun )<span class="sc">^</span>(T2 <span class="sc">/</span> n2)     <span class="co"># método secuencial</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="resultado" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="resultado"><span class="header-section-number">8.2.1</span> Resultado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fecha  =</span> <span class="fu">c</span>(<span class="st">"16‑jun"</span>, <span class="st">"9‑jul"</span>, <span class="st">"9‑ago"</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">UF     =</span> <span class="fu">c</span>(UF_ini,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(UF_9jul , <span class="dv">3</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(UF_9ago, <span class="dv">3</span>)),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Comentario =</span> <span class="fu">c</span>(<span class="st">"UF inicial"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Aplicando IPC mayo (23/30 días)"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Aplicando IPC junio (31/31 días)"</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Fecha"</span>, <span class="st">"UF calculada"</span>, <span class="st">"Descripción"</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption   =</span> <span class="st">"Evolución de la UF desde el 16‑jun al 9‑ago"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Evolución de la UF desde el 16‑jun al 9‑ago</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Fecha</th>
<th style="text-align: right;">UF calculada</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">16‑jun</td>
<td style="text-align: right;">39230.48</td>
<td style="text-align: left;">UF inicial</td>
</tr>
<tr class="even">
<td style="text-align: left;">9‑jul</td>
<td style="text-align: right;">39290.62</td>
<td style="text-align: left;">Aplicando IPC mayo (23/30 días)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9‑ago</td>
<td style="text-align: right;">39133.46</td>
<td style="text-align: left;">Aplicando IPC junio (31/31 días)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>##Gráfico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos base</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>UF_ini   <span class="ot">&lt;-</span> <span class="fl">39220.48</span>              <span class="co"># 16‑jun‑2025</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>ipc_mayo <span class="ot">&lt;-</span> <span class="fl">0.002</span>                 <span class="co"># +0,2 %</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>ipc_jun  <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.004</span>                <span class="co"># −0,4 %</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cronología</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2025-06-16"</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>end   <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2025-08-09"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(start, end, <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>UF    <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(dates))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>UF[<span class="dv">1</span>] <span class="ot">&lt;-</span> UF_ini</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># crecimiento diario prorrateado</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(dates)){</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> dates[i<span class="dv">-1</span>]</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(d <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-06-10"</span>) <span class="sc">&amp;</span> d <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-07-09"</span>)){</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    r_daily <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> ipc_mayo)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">30</span>) <span class="sc">-</span> <span class="dv">1</span>      <span class="co"># IPC mayo</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {                                    <span class="co"># 10‑jul a 9‑ago</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    r_daily <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> ipc_jun)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">31</span>)  <span class="sc">-</span> <span class="dv">1</span>      } <span class="co">#ipc julio</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  UF[i] <span class="ot">&lt;-</span> UF[i<span class="dv">-1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> r_daily)}</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, UF, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"fecha"</span>, <span class="at">ylab =</span> <span class="st">"UF"</span>,</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Variación diaria de la UF (16-jun&nbsp;–&nbsp;9-ago&nbsp;2025)"</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusión" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="conclusión"><span class="header-section-number">8.3</span> Conclusión</h2>
<ol type="1">
<li>La UF al 9 de agosto se obtiene encadenando los factores diarios de inflación correspondientes a los IPC de mayo y junio.</li>
<li>Un IPC mensual negativo hace que la UF baje; en el ejemplo cae desde 39290,61 (9 jul) a 39133,45 (9 ago).</li>
</ol>
</section>
</section>
<section id="activo-modelo-blackscholes-y-paridad-putcall" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Activo: Modelo Black‑Scholes y paridad put‑call</h1>
<p><strong>Definición</strong></p>
<p>El <strong>modelo de Black‑Scholes</strong> valora opciones europeas sobre un activo que no reparte dividendos, suponiendo volatilidad constante y mercado sin fricciones.<br>
El precio de la call (C) y de la put (P) se obtiene a partir de los factores (d_1) y (d_2); luego, la <strong>paridad put‑call</strong> relaciona ambos precios con el subyacente y el strike.</p>
<section id="ejemplo-clases-4" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="ejemplo-clases-4"><span class="header-section-number">9.1</span> Ejemplo (Clases)</h2>
<p>Una acción de <strong>L’Oréal</strong> cotiza a ** (S_0 = 380 ,€)**.<br>
Parámetros del contrato:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Volatilidad (σ)</td>
<td>16 % anual</td>
</tr>
<tr class="even">
<td>Tasa libre de riesgo (r) (continua)</td>
<td>4 % anual</td>
</tr>
<tr class="odd">
<td>Tiempo al vencimiento (T)</td>
<td>2 años</td>
</tr>
<tr class="even">
<td>Strike (K)</td>
<td>378 €</td>
</tr>
</tbody>
</table>
<p>Se pide el <strong>precio de la call y la put europeas</strong> con estos datos.</p>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
d_1 = \frac{\ln(S_0/K) + (r + \sigma^{2}/2)\,T}{\sigma\sqrt{T}}
\qquad
d_2 = d_1 - \sigma\sqrt{T}
\]</span></p>
<p><span class="math display">\[
C = S_0\,N(d_1) - K\,e^{-rT}\,N(d_2)
\qquad
P = K\,e^{-rT}\,N(-d_2) - S_0\,N(-d_1)
\]</span></p>
<p>por paridad también se cumple</p>
<p><span class="math display">\[
P = C + K\,e^{-rT} - S_0
\]</span></p>
<p>N es la función de distribución acumulada de la normal estándar.</p>
</section>
<section id="código-r-7" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="código-r-7"><span class="header-section-number">9.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>S0    <span class="ot">&lt;-</span> <span class="dv">380</span>      <span class="co"># precio spot</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>K     <span class="ot">&lt;-</span> <span class="dv">378</span>      <span class="co"># strike</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.16</span>     <span class="co"># volatilidad</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>r     <span class="ot">&lt;-</span> <span class="fl">0.04</span>     <span class="co"># tasa libre de riesgo</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>T     <span class="ot">&lt;-</span> <span class="dv">2</span>        <span class="co"># años hasta el vencimiento</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># factores d1 y d2</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> (<span class="fu">log</span>(S0<span class="sc">/</span>K) <span class="sc">+</span> (r <span class="sc">+</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> T) <span class="sc">/</span> (sigma <span class="sc">*</span> <span class="fu">sqrt</span>(T))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d1 <span class="sc">-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(T)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># distribucion normal</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># precios</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> S0 <span class="sc">*</span> <span class="fu">N</span>(d1) <span class="sc">-</span> K <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>T) <span class="sc">*</span> <span class="fu">N</span>(d2)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>put  <span class="ot">&lt;-</span> K <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>T) <span class="sc">*</span> <span class="fu">N</span>(<span class="sc">-</span>d2) <span class="sc">-</span> S0 <span class="sc">*</span> <span class="fu">N</span>(<span class="sc">-</span>d1)     <span class="co"># Fórmula directa</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>put_paridad <span class="ot">&lt;-</span> call <span class="sc">+</span> K <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>T) <span class="sc">-</span> S0         <span class="co"># chequeo paridad</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-6" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="tabla-de-resultados-6"><span class="header-section-number">9.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  Parámetro <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"d₁"</span>, <span class="st">"d₂"</span>, <span class="st">"Call (€)"</span>, <span class="st">"Put (€)"</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valor     =</span> <span class="fu">c</span>(<span class="fu">round</span>(d1, <span class="dv">4</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(d2, <span class="dv">4</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(call, <span class="dv">2</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(put, <span class="dv">2</span>)))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Valor"</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption   =</span> <span class="st">"Factores Black–Scholes y precios de la opción europea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Factores Black–Scholes y precios de la opción europea</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">d₁</td>
<td style="text-align: right;">0.4900</td>
</tr>
<tr class="even">
<td style="text-align: left;">d₂</td>
<td style="text-align: right;">0.2637</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Call (€)</td>
<td style="text-align: right;">50.6500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Put (€)</td>
<td style="text-align: right;">19.5900</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="resultado-y-conclusión-6" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="resultado-y-conclusión-6"><span class="header-section-number">9.3</span> Resultado y Conclusión</h2>
<ul>
<li><strong>Precio de la call europea</strong>: <strong>50,65 €</strong></li>
<li><strong>Precio de la put europea</strong>: <strong>19,59 €</strong></li>
</ul>
<p>El valor de la put obtenido por fórmula directa coincide con el de la paridad put‑call, validando el cálculo. El precio spot es mayor, comparado con el strike, esto inidca que la call esta in the money.</p>
</section>
</section>
<section id="bibliografia" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Bibliografia</h1>
<ul>
<li><p>Betzuen Zalbidegoitia, A., &amp; Betzuen Álvarez, A. J. (2016). <em>Estrategias de cobertura financiera y de gestión con instrumentos derivados: Tema 1. Instrumento financiero FRA</em>. OCW. </p></li>
<li><p>Hull, J. C. (2009). <em>Introducción a los mercados de futuros y opciones</em> (6.ª ed.). Pearson Educación de México. </p></li>
</ul>
</section>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>